---
layout: page
---

# Assignments

The assignments are mainly to give you exposure to different concepts and try  systems out.  The assignments will require some elbow grease.

## A0-3: Databass

Follow the directions in [the databass repository](https://github.com/w6113/databass-public/tree/master/docs)

<!--
## (Optional) A4: Try Differential Dataflow

Teams of 2

* Go to [Materialize.io](http://materialize.io) and install the system 
* Go through the [getting started documentation](https://materialize.io/docs/get-started/)
  * [You can also try it out in the browser](https://materialize.io/docs/katacoda/?intro-wikipedia)

-->

## (Optional) A4: Try Datalog

Teams of 2

Setup

* [Install souffle](https://souffle-lang.github.io/install)
* Go through the [tutorial](https://souffle-lang.github.io/tutorial)
* Download the [SQLite database](https://github.com/w6113/databass/blob/master/docs/a5.db?raw=true) for the assignment.  Store it in the directory you will be completing the assignment in.  This database contains the abstract syntax trees and query plans generated by DataBass for a large number of queries.  

The dataset

* `nodes(qid, nid, plantype, type)` stores each query id, node id, whether the plan is from the AST, unoptimized plan, or optimized plan, and the node type
* `attrs(nid, name, numval, strval)` stores the attributes of a node, one row for each attribute.  The value is stored in `numval` if it is numeric, and in `strval` otherwise.
* `edges(pid, cid, label)` stores the parent and child node ids, and an optional label if the child node was an attribute of the parent node (rather than a relational child operator).  For instance, the predicate in a filter operator is an attribute.


Write the `.dl` programs to answer at least 2 of the following questions

1. Write a datalog program in `q1.dl` that analyzes query ASTs.  Return all query ids that contain two or more nestings of subqueries. One nesting means the query contains a subquery.  Two means that a subquery contains a subquery.
1. Write a datalog program in `q2.dl` that finds all query ids whose optimized plan contains one or more Hash Join operators between tables T3 and T4.
1. Write a datalog program in `q3.dl` that returns the query ids of all optimized plans that contain one or more hash paths.  A hash path (a made up term) is a path from the root to a leaf operator that contains exactly one HashJoin operator.


### Submission

TBA


## A5: Try Lineage Systems

The goal of this assignment is to play with two lineage-capture systems, and go through the process of performance evaluation.
Your task will be to benchmark the two systems and analyze the findings.


### Step 1: GPROM

Setup

* Follow the instructions to install [GPROM + SQLite](https://github.com/IITDBGroup/gprom)
* Download the small [TPC-h](./files/TPC-H-small.db ) SQLite database (thanks to [lovasoa/TPCH-sqlite](https://github.com/lovasoa/TPCH-sqlite))

```
SELECT l.l_orderkey, 
       sum(l.l_extendedprice * (1-l.l_discount)) as revenue, 
       o.o_orderdate, 
       o.o_shippriority 
FROM (select * from customer limit 200) as c, 
     (select * from orders limit 200) as o, 
     (select * from lineitem limit 200) as l 
WHERE c.c_custkey = o.o_custkey AND 
      l.l_orderkey = o.o_orderkey 
GROUP BY l.l_orderkey, o.o_orderdate, o.o_shippriority
``` 

### Step 2: Databass-Smoke

It turns out Databass also supports lineage capture, as described [in the Smoke paper](./files/papers/smoke-vldb18.pdf).  Of course, it is not nearly as performant, since Databass generates Python code instead of C++.  Regardless, in this step, you will implement lineage capture for the root operators (Yield, Collect), and then generate some lineage.

To do so, edit the file under `databass/compile/py/root.py` and follow the instructions in the comments.

Evaluate your code using the following unit tests.  We recommend you craft your own queries and ground truth to verify that your code is correct.

``` 
pytest test/a5.py -x
``` 


### Step 3: Benchmarking




Resources

* [Tips on organizing, running, and plotting experiments](https://github.com/researchsetup/researchsetup.github.io/wiki/code#running-experiments) 


### Submission

TBA
